% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/design_diagram.R
\name{design_diagram}
\alias{design_diagram}
\title{Create Study Design Diagram}
\usage{
design_diagram(
  data,
  variable_col = "variable",
  label_col = "label",
  dimension_col = "dimension",
  min_col = "measurement_min",
  max_col = "measurement_max",
  index_date_label = "Index Date\\n(Cohort Entry)",
  time_unit = "Days",
  show_variables_legend = TRUE,
  box_height = 0.6,
  text_size = 16,
  colors = NULL,
  text_left_align = FALSE,
  text_left_align_cutoffs = c(-90, 0)
)
}
\arguments{
\item{data}{A data.frame/tibble with study design parameters}

\item{variable_col}{Column name containing variable names (default: "variable")}

\item{label_col}{Column name containing variable labels (default: "label")}

\item{dimension_col}{Column name containing dimension (= Covariate ascertainment window, Washout Window, Eligibility Assessment Window, etc.) names (default: "dimension")}

\item{min_col}{Column name containing measurement window start (default: "measurement_min")}

\item{max_col}{Column name containing measurement window end (default: "measurement_max")}

\item{index_date_label}{Label for the index date line and plot title (default: "Index Date (Cohort Entry)")}

\item{time_unit}{Time unit for x-axis (default: "Days")}

\item{show_variables_legend}{Show legend with variables in each dimension (default: TRUE)}

\item{box_height}{Height of dimension boxes (default: 0.8)}

\item{text_size}{Base text size (default: 11)}

\item{colors}{Custom color palette. Can be:
- NULL (default): uses RColorBrewer Set3 palette
- Unnamed character vector: colors assigned to dimensions in order of appearance
- Named character vector/list: dimension names as keys, colors as values}

\item{text_left_align}{If TRUE, left-aligns text for index point measurements; useful when measurements window are too small to fit large text elements (default: FALSE)}

\item{text_left_align_cutoffs}{Numeric vector of length 2 specifying cutoffs for left alignment (default: c(-90, 0)). If text_left_align is TRUE, text will be left-aligned for measurements with min_time >= -90 and max_time <= 0.}
}
\value{
A ggplot2 object
}
\description{
Creates a ggplot2-based study design diagram showing measurement windows
relative to an index date (cohort entry). Based on principles from
Schneeweiss et al. (2019) Ann Intern Med.
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
}
\examples{
\dontrun{
# Example data structure for study design diagram
library(encore.analytics)
library(tibble)

params <- tribble(
  ~variable, ~label, ~encoding, ~dimension, ~measurement_min, ~measurement_max,
  "c_age", "Age [yrs]", "continuous", "Covariate Assessment Window", 0, 0,
  "c_sex", "Sex", "binary", "Covariate Assessment Window", 0, 0,
  "c_ecog", "ECOG Performance Status", "ordinal", "Eligibility Assessment Window", -90, -1,
  "c_comorbidity", "Comorbidity Score", "continuous", "Covariate Assessment Window", -365, -1,
  "c_prior_tx", "Prior Treatment", "binary", "Washout Window", -180, -1,
  "outcome", "Overall Survival", "time-to-event", "Follow-up Period", 0, 365
  )

# Basic usage
design_diagram(params)

# With custom colors using named list/vector (dimension name -> color)
custom_colors <- c(
 "Covariate Assessment Window" = "steelblue",
 "Eligibility Assessment Window" = "darkblue",
 "Washout Window" = "darkgrey",
 "Follow-up Period" = "forestgreen"
 )

design_diagram(params, colors = custom_colors)
}
}
\references{
Schneeweiss S, Rassen JA, Brown JS, Rothman KJ, Happe L, Arlett P, Dal Pan G, Goettsch W, Murk W, Wang SV.
Graphical Depiction of Longitudinal Study Designs in Health Care Databases.
Ann Intern Med. 2019 Mar 19;170(6):398-406. doi: 10.7326/M18-3079. Epub 2019 Mar 12. PMID: 30856654.
}
